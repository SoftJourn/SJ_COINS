DROP TABLE accounts IF EXISTS CASCADE;
DROP TABLE transactions IF EXISTS;
DROP TABLE tx_calling_data IF EXISTS;
DROP TABLE transaction_history IF EXISTS;

CREATE TABLE accounts
(
  ldap_id      VARCHAR(255) NOT NULL PRIMARY KEY,
  amount       DECIMAL(10),
  full_name    VARCHAR(255),
  account_type VARCHAR(32) DEFAULT 'REGULAR',
  image        VARCHAR(255),
  is_new       BOOLEAN     DEFAULT 1,
  deleted      BOOLEAN     DEFAULT 0
);

CREATE TABLE transactions
(
  id BIGINT PRIMARY KEY NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  account_ldap_id VARCHAR(255),
  destination_ldap_id VARCHAR(255),
  amount DECIMAL(10),
  comment VARCHAR(255),
  created TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
  status VARCHAR(32) NOT NULL,
  error VARCHAR(255),
  remain DECIMAL(19,2),
  eris_transaction_id VARCHAR(255),
  CONSTRAINT account_fk FOREIGN KEY (account_ldap_id) REFERENCES accounts (ldap_id),
  CONSTRAINT destination_fk FOREIGN KEY (destination_ldap_id) REFERENCES accounts (ldap_id)
);

CREATE TABLE transaction_history (
  id                    BIGINT PRIMARY KEY NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  block_number          BIGINT       DEFAULT NULL,
  chain_id              VARCHAR(255) DEFAULT NULL,
  function_name         VARCHAR(255) DEFAULT NULL,
  time                  DATETIME     DEFAULT NULL,
  amount                BIGINT DEFAULT NULL,
  caller_address        VARCHAR(255) DEFAULT NULL,
  caller_pub_key        VARCHAR(255) DEFAULT NULL,
  calling_data          VARCHAR(2500),
  contract_address      VARCHAR(255) DEFAULT NULL,
  fee                   BIGINT DEFAULT NULL,
  function_name_hash    VARCHAR(255) DEFAULT NULL,
  gas_limit             BIGINT DEFAULT NULL,
  is_deploy             BIT(1)       DEFAULT NULL,
  sequence              BIGINT DEFAULT NULL,
  transaction_signature VARCHAR(255) DEFAULT NULL,
  tx_id                 VARCHAR(255) DEFAULT NULL,
  tx_type_call          TINYINT      DEFAULT NULL
);

CREATE TABLE tx_calling_data
(
  tx_id         BIGINT       NOT NULL,
  calling_value VARCHAR(255),
  function_name VARCHAR(255) NOT NULL,
  CONSTRAINT PRIMARY_KEY PRIMARY KEY (tx_id, function_name),
  CONSTRAINT FKcdwwj4qxq3unv7cveilenig5d FOREIGN KEY (tx_id) REFERENCES transaction_history (id)
);

INSERT INTO accounts (ldap_id, full_name, image, is_new, account_type, deleted) VALUES ('ovovchuk', 'Oleksandr Vovchuk', 'images/default.png', false, 'REGULAR', false);
INSERT INTO accounts (ldap_id, full_name, image, is_new, account_type, deleted) VALUES ('oyevchuk', 'Olga Yevchuk', 'images/default.png', false, 'REGULAR', false);
INSERT INTO accounts (ldap_id, full_name, image, is_new, account_type, deleted) VALUES ('vdanyliuk', 'Vasyl Danyliuk', 'images/default.png', false, 'REGULAR', false);

INSERT INTO transactions VALUES (742,'ovovchuk','vdanyliuk',100,'Filling account vdanyliuk by 100 coins',         '2016-11-11 05:28:20','SUCCESS',NULL,NULL,         '5C37675ECFADF13DF7ECA8165FE278AB264655D9');
INSERT INTO transactions VALUES (745,'ovovchuk','oyevchuk',100,'Filling account vdanyliuk by 100 coins',         '2016-11-12 05:29:05','SUCCESS',NULL,NULL,         '2A6A14CB249BB7FE0D8494BAA82244D20A1EF684');
INSERT INTO transactions VALUES (746,'ovovchuk','oyevchuk',1000,'Filling account vdanyliuk by 1000 coins',       '2016-11-13 06:28:20','SUCCESS',NULL,NULL,       '5C37675ECFADF13DF7ECA8165FE2FFFB264655D9');
INSERT INTO transactions VALUES (747,'ovovchuk','vdanyliuk',1000,'Filling account vdanyliuk by 1000 coins',       '2016-11-14 06:29:05','SUCCESS',NULL,NULL,       '2A6A14CB249BB7FE0D8494BCCC2244D20A1EF684');
INSERT INTO transactions VALUES (748,'ovovchuk','vdanyliuk',10000,'Filling account vdanyliuk by 10000 coins',     '2016-11-15 07:28:20','SUCCESS',NULL,NULL,     '5C37675ECFADF13DF7ECA8165FE27BBB264655D9');
INSERT INTO transactions VALUES (749,'vdanyliuk','oyevchuk',10000,'Filling account vdanyliuk by 10000 coins',     '2016-11-16 07:29:05','SUCCESS',NULL,NULL,     '2A6A14CB249BB7FE0D8494EEE82244D20A1EF684');
INSERT INTO transactions VALUES (750,'vdanyliuk','ovovchuk',100000,'Filling account vdanyliuk by 100000 coins',   '2016-11-17 08:28:20','SUCCESS',NULL,NULL,   '5C37675ECFADF13DDDECA8165FE278AB264655D9');
INSERT INTO transactions VALUES (751,'vdanyliuk','ovovchuk',100000,'Filling account vdanyliuk by 100000 coins',   '2016-11-18 08:29:05','SUCCESS',NULL,NULL,   '2A6A14CB249BB7FEFF8494BAA82244D20A1EF684');
INSERT INTO transactions VALUES (752,'oyevchuk','vdanyliuk',1000000,'Filling account vdanyliuk by 1000000 coins', '2016-11-19 09:28:20','SUCCESS',NULL,NULL, '5437675ECFADF13DF7ECA8165FE278AB264655D9');
INSERT INTO transactions VALUES (753,'oyevchuk','ovovchuk',1000000,'Filling account vdanyliuk by 1000000 coins', '2016-11-20 09:29:05','SUCCESS',NULL,NULL, '2A3333CB249BB7FE0D8494BAA82244D1234EF684');

INSERT INTO transaction_history VALUES (270, 3688719, 'SJTestChain', 'transfer', '2016-11-11 05:28:20', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','5C37675ECFADF13DF7ECA8165FE278AB264655D9',2);
INSERT INTO transaction_history VALUES (271, 3688767, 'SJTestChain', 'transfer', '2016-11-12 05:29:05', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','2A6A14CB249BB7FE0D8494BAA82244D20A1EF684',2);
INSERT INTO transaction_history VALUES (272, 3688999, 'SJTestChain', 'transfer', '2016-11-13 06:28:20', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','5C37675ECFADF13DF7ECA8165FE2FFFB264655D9',2);
INSERT INTO transaction_history VALUES (273, 3698719, 'SJTestChain', 'transfer', '2016-11-14 06:29:05', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','2A6A14CB249BB7FE0D8494BCCC2244D20A1EF684',2);
INSERT INTO transaction_history VALUES (274, 3699719, 'SJTestChain', 'transfer', '2016-11-15 07:28:20', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','5C37675ECFADF13DF7ECA8165FE27BBB264655D9',2);
INSERT INTO transaction_history VALUES (275, 3788719, 'SJTestChain', 'transfer', '2016-11-16 07:29:05', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','2A6A14CB249BB7FE0D8494EEE82244D20A1EF684',2);
INSERT INTO transaction_history VALUES (276, 3888719, 'SJTestChain', 'transfer', '2016-11-17 08:28:20', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','5C37675ECFADF13DDDECA8165FE278AB264655D9',2);
INSERT INTO transaction_history VALUES (277, 3988719, 'SJTestChain', 'transfer', '2016-11-18 08:29:05', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','2A6A14CB249BB7FEFF8494BAA82244D20A1EF684',2);
INSERT INTO transaction_history VALUES (278, 4688719, 'SJTestChain', 'transfer', '2016-11-19 09:28:20', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','5437675ECFADF13DF7ECA8165FE278AB264655D9',2);
INSERT INTO transaction_history VALUES (279, 5688719, 'SJTestChain', 'transfer', '2016-11-20 09:29:05', 1, '2C76A03ADA83E4F0A9DD9D8FBFC54E5EE4026C3F', '', 'A9059CBB000000000000000000000000558E41DD4FE5656E7961BD3D8639CB071F7EA3170000000000000000000000000000000000000000000000000000000000000000','FC7A363EE4BDDF8E83389A157D95FD12AE3A1EFB', 0, 'A9059CBB', 2147483647, 0, 674, '1EFB4D8970F2F0E3A5F11FB78A23E49C04100A744D5FBE47B6F48A2F1DDB7950B9D3CEB9EA5E284EA995B8D1DA40826D34A43E1D028E0EC5D1FA7F8887565A06','2A3333CB249BB7FE0D8494BAA82244D1234EF684',2);

INSERT INTO tx_calling_data VALUES (270,'100','amount');
INSERT INTO tx_calling_data VALUES (270,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (271,'100','amount');
INSERT INTO tx_calling_data VALUES (271,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (272,'100','amount');
INSERT INTO tx_calling_data VALUES (272,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (273,'100','amount');
INSERT INTO tx_calling_data VALUES (273,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (274,'100','amount');
INSERT INTO tx_calling_data VALUES (274,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (275,'100','amount');
INSERT INTO tx_calling_data VALUES (275,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (276,'100','amount');
INSERT INTO tx_calling_data VALUES (276,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (277,'100','amount');
INSERT INTO tx_calling_data VALUES (277,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (278,'100','amount');
INSERT INTO tx_calling_data VALUES (278,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');

INSERT INTO tx_calling_data VALUES (279,'100','amount');
INSERT INTO tx_calling_data VALUES (279,'356D856985632C828A04C5D337EC7B9B7BDED21D','receiver');